(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(975)}])},975:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var i=n(7568),s=n(4051),o=n.n(s),a=n(5893),c=n(7294),r=n(9008),l=n.n(r),u=n(6562),d=n(7063),h=function(e){return(0,a.jsx)(u.Card,{padding:"space70",element:"METRIC",children:(0,a.jsxs)(u.Text,{as:"div",textAlign:"center",children:[(0,a.jsx)(u.Text,{as:"h2",color:"colorTextDecorative10",lineHeight:"lineHeight80",fontSize:"fontSize60",fontWeight:"fontWeightLight",marginBottom:"space60",children:e.label}),(0,a.jsx)(u.Text,{as:"div",fontSize:"fontSize110",fontWeight:"fontWeightMedium",lineHeight:"lineHeight80",children:e.value})]})})},g=function(){return(0,a.jsx)(u.Box,{textAlign:"center",padding:"space40",backgroundColor:"colorBackgroundBodyInverse",children:(0,a.jsx)(u.Text,{as:"h2",lineHeight:"lineHeight100",fontSize:"fontSize100",fontWeight:"fontWeightMedium",margin:"space70",color:"colorTextBrandInverse",children:"Service Desk Phone Queue"})})},f=function(e){return(0,a.jsx)(u.Box,{textAlign:"center",padding:"space40",backgroundColor:"colorBackgroundBodyInverse",className:"footer",children:(0,a.jsx)(u.Text,{as:"h2",lineHeight:"lineHeight60",fontSize:"fontSize60",fontWeight:"fontWeightMedium",color:"colorTextBrandInverse",children:e.value})})},p=n(1137),v=n.n(p),x=n(1438),k=function(){function e(){(0,x.Z)(this,e)}return e.fmtSeconds=function(e){var t=new Date(0);return t.setSeconds(e),t.toISOString().slice(11,-8)},e.parse=function(e){var t=[];t.push({label:"Calls Waiting",value:e.workspace_statistics.realtime.tasks_by_status.pending}),t.push({label:"Longest Waiting",value:e.workspace_statistics.realtime.longest_task_waiting_age}),t.push({label:"Reservations Accepted",value:e.workspace_statistics.cumulative.reservations_accepted}),t.push({label:"Tasks Canceled",value:e.workspace_statistics.cumulative.tasks_canceled}),t.push({label:"ASA",value:e.workspace_statistics.cumulative.avg_task_acceptance_time});var n=e.workspace_statistics.realtime.total_workers-e.workspace_statistics.realtime.activity_statistics.find((function(e){return"Offline"===e.friendly_name})).workers;return t.push({label:"Logged In Agents",value:n.toString()}),t.push({label:"Longest Waiting",value:this.fmtSeconds(e.workspace_statistics.realtime.tasks_by_status.pending)}),t.push({label:"ASA",value:this.fmtSeconds(e.workspace_statistics.cumulative.avg_task_acceptance_time)}),t},e}(),m=function(){return(0,a.jsx)(u.Card,{padding:"space70",element:"METRIC",children:(0,a.jsxs)(u.Text,{as:"div",textAlign:"center",children:[(0,a.jsx)(u.Text,{as:"h2",color:"colorTextDecorative10",lineHeight:"lineHeight80",fontSize:"fontSize60",fontWeight:"fontWeightLight",marginBottom:"space60",children:(0,a.jsx)(u.SkeletonLoader,{})}),(0,a.jsx)(u.Text,{as:"div",fontSize:"fontSize110",fontWeight:"fontWeightMedium",lineHeight:"lineHeight80",children:(0,a.jsx)(u.SkeletonLoader,{})})]})})},_=function(){var e=(0,c.useState)(!0),t=e[0],n=e[1],s=(0,c.useState)(),r=s[0],p=s[1],x=(0,c.useState)(),_=x[0],S=x[1],w=(0,c.useState)(),T=w[0],j=w[1],b=function(){return fetch("".concat("","/syncToken")).then((function(e){return e.json()})).then((function(e){return S("Got access token"),e.token})).catch((function(e){S("Could not fetch token"),console.error("Error getting token",e)}))};(0,c.useEffect)((function(){return(0,i.Z)(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Fetching access token"),S("Fetching access token"),e.next=4,b();case 4:t=e.sent,console.log("Creating new sync client"),S("Creating new sync client"),(n=new(v())(t)).on("tokenAboutToExpire",(0,i.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Updating token for sync client"),S("Fetching new access token"),e.next=4,b();case 4:t=e.sent,n.updateToken(t),S("Updated access token");case 7:case"end":return e.stop()}}),e)})))),j(n);case 10:case"end":return e.stop()}}),e)})))(),function(){T&&(console.log("Shutting down sync client"),S("Shutting down sync client"),T.shutdown(),j(void 0))}}),[]),(0,c.useEffect)((function(){null!=T&&T.document("dashboardStats").then((function(e){console.log("Sync doc updated",e.value);var t=k.parse(e.value);p(t),n(!1),S("Updated "+(new Date).toTimeString()),e.on("updated",(function(t){console.log("Sync doc updated",e.value);var n=k.parse(t.value);console.log("Got stats",n),p(n),S("Last update "+(new Date).toTimeString())}))}))}),[T]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Flex Wallboard"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsx)(g,{}),(0,a.jsx)(d.Box,{as:"main",padding:"space30",children:(0,a.jsxs)(u.Grid,{gutter:["space20","space60","space90"],vertical:[!0,!0,!1],element:"STATGRID",children:[t&&[1,2,3,4,5,6].map((function(e){return(0,a.jsx)(u.Column,{span:4,element:"STAT",children:(0,a.jsx)(m,{})},e)})),r&&r.map((function(e,t){return(0,a.jsx)(u.Column,{span:4,element:"STAT",children:(0,a.jsx)(h,{label:e.label,value:e.value})},t)}))]})}),(0,a.jsx)(f,{value:_})]})}},4064:function(){},9831:function(){}},function(e){e.O(0,[422,665,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);